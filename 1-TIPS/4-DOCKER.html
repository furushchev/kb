
<!DOCTYPE HTML>
<html lang="ja" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>
    
        Docker · Furushchev Knowledge Base
    
</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Yuki Furuta">
        
        
    <link rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
        integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7"
        crossorigin="anonymous">
    <link rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.0/css/font-awesome.min.css"
        integrity="sha384-I6JCnqxMbC2DuiHjsoCiLa15NVbKRf8/ooANRLsXD87zD2dVqzlz6Oqjvj470ztk"
        crossorigin="anonymous">
    <link rel="stylesheet" href="../gitbook/style.css">
    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-codeblock-filename/block.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-disqus/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-pretty-term/terminal.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    </head>
    <body>
        
<nav class="faq-navbar navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-menu" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="..">
                Furushchev Knowledge Base
            </a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-menu">
            
        </div>
    </div>
</nav>

<div class="faq-header">
    <div class="container">
    <h1>
        
            
                Docker
            
        
    </h1>

    
<div id="book-search-input" role="search">
    <input type="text" placeholder="検索すると入力" />
</div>


    
    </div>
</div>

<div class="faq-page-container">

<div id="book-search-results">
    <div class="search-noresults">
    
    
    
        <div class="panel panel-default">
            <div class="panel-body">
                <ol class="breadcrumb">
                    <li><a href="..">FAQ</a></li>
                    
                        
                            
                        
                    
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>1-TIPS</li>
                            
                        
                    
                        
                            
                        
                            
                        
                            
                        
                    
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                    
                    <li class="active">Docker</li>
                </ol>
                <div class="faq-page">
                <h1 id="docker">Docker</h1>
<h2 id="change-the-location-of-docker-images--data">Change the location of docker images / data</h2>
<p>Docker images are located under <code>/var/lib/docker</code> on Ubuntu by default.
To change the directory, it is required to pass <code>-g</code> option to docker daemon process.
To do it, edit <code>DOCKER_OPTS</code> environment variables in <code>/etc/default/docker</code>.</p>
<pre><code class="lang-diff"><span class="hljs-deletion">- DOCKER_OPTS=</span>
<span class="hljs-addition">+ DOCKER_OPTS=&quot;-g /path/to/docker-image&quot;</span>
</code></pre>
<p>And then restart docker daemon process:</p>
<pre><code class="lang-bash"><span class="hljs-comment"># Ubuntu 14.04</span>
sudo restart docker
</code></pre>
<pre><code class="lang-bash"><span class="hljs-comment"># Ubuntu 16.04</span>
sudo systemctl stop docker.service
sudo systemctl start docker.service
</code></pre>
<h2 id="launch-private-registry-server">Launch Private Registry Server</h2>
<h3 id="create-private-registry">Create private registry</h3>
<p>Instead of using Docker official registry, we can also create and run our own docker registory that docker images are stored and managed.
The private registry can also be run as one docker image.</p>
<ul>
<li>Images stored in private registry in the host machine: <code>/media/docker/registry</code></li>
<li>Port of docker registry server: <code>5000</code></li>
<li>Port of docker registry frontend: <code>8080</code></li>
</ul>
<p>Before run a registry server, set the appropriate hostname to your server.</p>
<p>To run registry server, run the commands below:</p>
<pre><code class="lang-bash">mkdir -p /media/docker/registry
chmod -R 0777 /media/docker/registry
docker run <span class="hljs-_">-d</span> -p 5000:5000 -v /media/docker/registry:/var/lib/registry registry
</code></pre>
<p>And then also run the frontend for visualize images stored in the registry server.</p>
<pre><code class="lang-bash">docker run <span class="hljs-_">-d</span> <span class="hljs-_">-e</span> ENV_DOCKER_REGISTRY_HOST=&lt;hostname&gt; <span class="hljs-_">-e</span> ENV_DOCKER_REGISTRY_PORT=5000 -p 8080:80 konradkleine/docker-registry-frontend:v2
</code></pre>
<p>And you can see the frontend.</p>
<p><img src="https://user-images.githubusercontent.com/1901008/40100258-479c803a-591e-11e8-84f4-31a2cf35b33c.png" alt="docker"></p>
<h3 id="push-own-image-to-created-private-registry">Push own image to created private registry</h3>
<p>Docker determines the destination of pushed image by its tag as followings: <code>&lt;host&gt;:&lt;port&gt;/&lt;image&gt;:&lt;version&gt;</code>.
If <code>&lt;host&gt;:&lt;port&gt;/</code> is abbreviated, docker pushes its image to the official docker hub.
So, all we need to do is to tag images.</p>
<pre><code class="lang-bash">docker pull osrf/ros:kinetic-desktop
docker tag osrf/ros:kinetic-desktop &lt;host&gt;:5000/osrf/ros:kinetic-desktop
docker push &lt;host&gt;:5000/osrf/ros:kinetic-desktop
</code></pre>
<p>This pushes images to the registry server located on <code>&lt;host&gt;:5000</code>.</p>

                </div>
            </div>
        </div>

        
            
        
    


    
    <div class="faq-page-footer">
        <a href="https://www.gitbook.com" target="_blank">GitBookで公開 </a> ·
        <span>Last edit June 5th 2018</span>
    </div>
    

    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results for "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

</div>

        
<script src="../gitbook/gitbook.js"></script>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script>
    

    
    <script src="../gitbook/gitbook-plugin-disqus/plugin.js"></script>
    

    
    <script src="../gitbook/gitbook-plugin-pretty-term/terminal.js"></script>
    

    
    <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
    

    
    <script src="../gitbook/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
    

    
    <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
    

<script>
(function() {
    gitbook.page.hasChanged({"page":{"title":"Docker","level":"2.4","depth":1,"next":{"title":"RN-42 bluetoothモジュール","level":"3.1","depth":1,"path":"2-HACKS/1-RN-42.md","ref":"2-HACKS/1-RN-42.md","articles":[]},"previous":{"title":"SSHの接続クライアントをアドレスごとに制限する","level":"2.3","depth":1,"path":"1-TIPS/3-SSH-IP.md","ref":"1-TIPS/3-SSH-IP.md","articles":[]},"dir":"ltr"},"config":{"plugins":["codeblock-filename","katex","disqus","summary","pretty-term","theme-faq","-fontsettings","-sharing"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"disqus":{"useIdentifier":false,"shortName":"furshchev"},"pretty-term":{},"summary":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"katex":{},"theme-faq":{},"highlight":{},"codeblock-filename":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"Yuki Furuta","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Furushchev Knowledge Base","language":"ja","gitbook":"*"},"file":{"path":"1-TIPS/4-DOCKER.md","mtime":"2018-06-05T01:36:08.146Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-06-05T01:37:07.527Z"},"basePath":"..","book":{"language":""}})
})();
</script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    </body>
</html>

